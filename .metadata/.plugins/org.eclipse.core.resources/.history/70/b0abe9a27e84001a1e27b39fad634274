package com.aeox.jkaiser.dto;

import java.util.LinkedList;
import java.util.List;

import lombok.Data;

@Data
public abstract class Job {
	private String name;
	private String version;
	private TaskTreeNode entrypoint;
	private Status status;
	
	public List<Result<?>> run(final JobContext context) {
		final List<Result<?>> results = new LinkedList<>();
		
		TaskTreeNode taskToExecute = this.entrypoint;	
		while(taskToExecute != null) {
			final Result<?> result = taskToExecute.getCurrent().run(context);
			results.add(result);
			if (result.wasError()) {
				taskToExecute = taskToExecute.getOnFailure();
			} else {
				taskToExecute = taskToExecute.getOnSuccess();
			}
		}
		return results;		
	}
}
